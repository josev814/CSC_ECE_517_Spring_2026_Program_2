<div class="row justify-content-end p-3">
    <% if @hours_logged.nil?.eql?(false) %>
    Pending Hours: <%= @hours_logged[:pending_hours] %> | Completed Hours: <%= @hours_logged[:completed_hours] %>
    <% end %>
</div>
<table class="table table-striped">
    <thead>
        <tr>
            <th scope="col"></th>
            <th scope="col">Volunteer</th>
            <th scope="col">Event</th>
            <th scope="col">Status</th>
            <th scope="col">Hours Logged</th>
            <th scope="col">Created Date</th>
            <th scope="col">Updated Date</th>
        </tr>
    </thead>
    <tbody>
        <tr id="filters" scope="row">
            <td class="col-1">Filter Data:</td>
            <td>
                <% if @filtered.eql?(0) %>
                    <%= select(VolunteerAssignment, :volunteer_id, Volunteer.all.collect {|v| [v.full_name, v.id]}, {include_blank: true}) %>
                <% else %>
                    <select name='VolunteerAssignment_volunteer_id' id='VolunteerAssignment_volunteer_id'>
                        <option value="">Remove Filter</option>
                        <option disabled><%= '-' * 10 %></option>
                        <% Volunteer.all.collect.each do |volunteer| %>
                            <option <%= (volunteer.id.eql?(@filtered.to_i)) ? 'selected':'' %> value="<%= volunteer.id %>"><%= volunteer.full_name %></option>
                        <% end %>

                    </select>
                <% end %>
            </td>
            <td colspan="5"></td>
        </tr>
    <% link_classes='link-dark link-underline-opacity-0 link-underline-opacity-75-hover' %>
    <% if @volunteer_assignments.nil? || @volunteer_assignments.length.eql?(0) %>
        <tr id="no_assignments" scope="row">
            <td colspan="7" class="text-danger">No Volunteer Assignments Found</td>
        </tr>
    <% else %>
        <% @volunteer_assignments.each do |volunteer_assignment| %>
            <tr id="<%= dom_id volunteer_assignment %>" scope="row">
                <td class="col-1">
                    <%= link_to volunteer_assignment, class: link_classes do %>
                        <i class="bi bi-eye-fill"></i> View
                    <% end %>
                    <br />
                    <%= link_to volunteer_assignment, class: link_classes, data: { turbo_method: :delete, turbo_confirm: 'Are you sure?' } do %>
                        <i class="bi bi-trash2-fill"></i> Delete
                    <% end %>
                </td>
                <td><%= volunteer_assignment.volunteer.full_name %></td>
                <td><%= volunteer_assignment.event.title %></td>
                <td class="col-2">
                    <%= volunteer_assignment.status %>
                    <% if volunteer_assignment.status.eql? 'pending' %>
                        <br />
                        <%= button_to volunteer_assignment_path(volunteer_assignment),
                                      params: {volunteer_assignment: {status: 'approved'} },
                                      method: 'patch',
                                      class: link_classes + ' btn-reset-styles mt-2' do %>
                            <i class="bi bi-clipboard-check-fill"></i> Approve
                        <% end %>
                    <% end %>
                </td>
                <td><%= number_with_precision(volunteer_assignment.hours_worked, precision: 1) if volunteer_assignment.hours_worked.present? %></td>
                <td class="col-2"><%= volunteer_assignment.created_at.to_fs(:long) %></td>
                <td class="col-2"><%= volunteer_assignment.updated_at.to_fs(:long) %></td>
            </tr>
        <% end %>
    <% end %>
    </tbody>
</table>
<script type="text/javascript">
    volunteer_filter = document.querySelector('select#VolunteerAssignment_volunteer_id')
    volunteer_filter.addEventListener('input', (event) => {
        window.location = '<%= volunteer_assignments_path %>?user_id=' + event.target.value
    })
</script>
